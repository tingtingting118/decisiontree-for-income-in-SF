#simple notes for further validations


#import data first
library(readxl)
income_data <- read_excel("C:/Users/karen/Downloads/UIC/ids572/hw2/income.data.xlsx", 
                            +     col_names = FALSE)

#add title for each column 
names(income_data)<-c("hh_income","Sex","martial status","age","education","occupation","timeinSF","dualincomes",
                      "hh_size","under18","hh_status","home_type","ethinic_class","lang_speak")

#clean missing values first
summary(income_data)

#found that some of the data are characters , including the "NA"-NEED TO MAKE THEM LOGICAL TYPE


income_data[income_data=="NA"]<-NA
#double check again
sum(!complete.cases(income_data))

#now start to find out all of them 
library(mice)
md.pattern(income_data)
#only 6876 cases are completed
#visualize that first
library("VIM")
na_plot<-aggr(income_data,col=c('blue','red'),numbers=TRUE,prop=TRUE,sortVars=TRUE,labels=names(income_data),cex.axis=1,gap=0,
              ylab=c("histrogram of missing values","pattern"))
#10% of data in timeinSF are missing now followed by the hh_size


#inputing the missing values using mice
#transform categorical var to factor first
income_data$`martial status`<-as.factor(income_data$`martial status`)
income_data$education<-as.factor(income_data$education)
income_data$occupation<-as.factor(income_data$occupation)
income_data$timeinSF<-as.factor(income_data$timeinSF)
income_data$hh_size<-as.factor(income_data$hh_size)
income_data$hh_status<-as.factor(income_data$hh_status)
income_data$home_type<-as.factor(income_data$home_type)
income_data$ethinic_class<-as.factor(income_data$ethinic_class)
income_data$lang_speak<-as.factor(income_data$lang_speak)
#now we could start the imputation 
init = mice(income_data[,-1], maxit=0) #skip hh_income as predictor
meth = init$method
predM = init$predictorMatrix


#for those variable which are not missing, we skip that for their imputation as well, but will be a predictor
meth[c("Sex","age","under18","dualincome")]=""

#now set different imputation for different variables
#ordinal
meth[c("timeinSF","hh_size","education")]="polyreg"


#nominal: lang_speak,home_type,"hh_status","martial status","occupation","ethic_class"

by doing some research, I have some ideas for these variable method
1. language-speaking & ethic_class might be related;
2. home_type could be replaced by its mode
 #marital status
#since most of them are single and never married
we treat these missing values for marital status as type 5
#impute language speaking,english for na

#hh_type
summary(income_data$home_type)
most peopel are having a home type of 1


3. household status & household income but might could use mode too, or number of rooms "hh_size"
4. occupation &education & age
5.




#start with Q1, which variable has effect on hh_income level

pairs(income_data$hh_income ~.,data=income_data)
#by plotting each other with hh_income, 

#nominal variable
#Sex,marital status,occupation, dual income,house status,type of home, ethinic classification ,language speaking
we use chi-square to test









